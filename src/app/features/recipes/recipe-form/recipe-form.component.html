<div fxLayout="row" fxLayoutAlign="center" fxFlex="100%">
  <mat-card [formGroup]="recipeForm" fxFlex="60%" fxLayout="column" fxLayoutAlign="center" class="main-container" fxLayoutGap="30px">
    <h1>Új recept felvétele</h1>
    <hr>
    <div fxLayout="column" fxLayoutAlign="center" fxLayoutGap="10px">
      <mat-card-title>Alapadatok</mat-card-title>
      <mat-form-field>
        <mat-label>Recept neve</mat-label>
        <input matInput type="text" formControlName="name" />
      </mat-form-field>
      <mat-card-subtitle>Tölts fel hozzá borítót:</mat-card-subtitle>
      <input type="file" formControlName="headerPhoto" (change)="onHeaderChange($event)" />
    </div>
    <hr>
    <div fxLayout="column" fxLayoutAlign="center" fxLayoutGap="10px">
      <mat-card-title>Lépések felvétele</mat-card-title>
      <mat-card fxLayout="column" class="table-container" *ngIf="descriptions.length">
        <div fxLayout="row" fxLayoutAlign="space-around" fxLayoutGap="10px" fxFlex="95%">
          <mat-card-title fxLayoutAlign="center" fxFlex="60%">Lépés szövege</mat-card-title>
          <mat-card-title fxLayoutAlign="center" fxFlex="20%">Illusztráció</mat-card-title>
          <mat-card-title fxLayoutAlign="center" fxFlex="20%">Szerkesztés</mat-card-title>
        </div>
        <div *ngFor="let desc of descriptions" fxLayout="row" fxLayoutAlign="space-around" fxLayoutGap="10px" fxFlex="95%">
          <p fxLayoutAlign="center" fxFlex="60%">{{desc.text}}</p>
          <p fxLayoutAlign="center" fxFlex="20%">{{desc.photo?.name}}</p>
          <mat-icon fxLayoutAlign="end" fxFlex="10%">
            edit
          </mat-icon>
          <mat-icon fxLayoutAlign="start" fxFlex="10%">
            delete
          </mat-icon>
        </div>
      </mat-card>
      <mat-card-subtitle>Lépés szövege:</mat-card-subtitle>
      <mat-form-field>
        <mat-label>Leírás</mat-label>
        <textarea matInput type="text" formControlName="description" cdkTextareaAutosize
          cdkAutosizeMinRows="4"></textarea>
      </mat-form-field>
      <mat-card-subtitle>Tölts fel hozzá illusztrációt:</mat-card-subtitle>
      <input type="file" (change)="onChange($event)" formControlName="descPhoto"/>
      <button (click)="saveDescription()" mat-raised-button type="submit">
        Lépés felvétele
      </button>
    </div>
    <hr>
    <div fxLayout="column" fxLayoutAlign="center" fxLayoutGap="10px">
      <mat-card-title>Hozzzávalók felvétele</mat-card-title>
      <mat-card *ngIf="uploadedIngredients.length" fxLayout="column" class="table-container">
        <div fxLayout="row" fxLayoutAlign="space-around" fxLayoutGap="10px" fxFlex="95%">
          <mat-card-title fxLayoutAlign="center" fxFlex="30%">Hozzávaló csoport</mat-card-title>
          <mat-card-title fxLayoutAlign="center" fxFlex="30%">Hozzávaló</mat-card-title>
          <mat-card-title fxLayoutAlign="center" fxFlex="30%">Szerkesztés</mat-card-title>
        </div>
        <div *ngFor="let ingredient of uploadedIngredients" fxLayout="row" fxLayoutAlign="space-around" fxLayoutGap="10px" fxFlex="95%">
          <p fxLayoutAlign="center" fxFlex="30%">{{ingredient.group}}</p>
          <p fxLayoutAlign="center" fxFlex="30%">{{ingredient.ingredient.amount}} {{ingredient.ingredient.unit}} {{ingredient.ingredient.name}}</p>
          <mat-icon fxLayoutAlign="end" fxFlex="15%">
            edit
          </mat-icon>
          <mat-icon fxLayoutAlign="start" fxFlex="15%">
            delete
          </mat-icon>
        </div>
      </mat-card>
      <mat-card-subtitle>Hozzávaló csoport</mat-card-subtitle>
    <mat-form-field>
      <mat-label>Hozzávaló csoport felvétele</mat-label>
      <input matInput type="text" formControlName="ingredientGroup" />
    </mat-form-field>
    <button (click)="saveIngredientGroup()" mat-raised-button type="submit">
      Csoport felvétele
    </button>
    <mat-card-subtitle>Hozzávaló elem felvétele</mat-card-subtitle>
    <mat-form-field>
      <mat-label>Válaszd ki, a hozzávaló csoportot!</mat-label>
      <mat-select formControlName="selectedIngredientGroup">
        <mat-option *ngFor="let ingredientGroup of groups" [value]="ingredientGroup">{{ingredientGroup.name}}</mat-option>
      </mat-select>
    </mat-form-field>
    <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between center">
      <mat-form-field fxFlex="70%">
        <mat-label>Válaszd ki, a hozzávalót!</mat-label>
        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayIngredient">
          <mat-option *ngFor="let ingredient of filteredIngredients" [value]="ingredient">{{ingredient.name}} ({{ingredient.unit}})</mat-option>
        </mat-autocomplete>
        <input matInput formControlName="ingredientName" type="text" [matAutocomplete]="auto">
      </mat-form-field>
      <button fxFlex="30%" mat-raised-button (click)="newIngredient()">Új felvétele</button>
    </div>
    <mat-form-field>
      <mat-label>Mennyiség</mat-label>
      <input matInput type="number" formControlName="ingredientAmount" />
    </mat-form-field>
    <button (click)="saveIngredient()" mat-raised-button type="submit">
      Hozzávaló felvétele
    </button>
    </div>
    <button (click)="saveRecipe()" mat-raised-button color="accent" type="submit">
      Recept mentése
    </button>
  </mat-card>
</div>